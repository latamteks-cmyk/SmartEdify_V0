---
id: jwks-rotation-state
title: "SmartEdify â€“ JWKS Key State Lifecycle"
description: "State machine for provisioning, promoting, retiring, and purging signing keys exposed via JWKS."
updated: 2025-02-14
tags: ["security", "jwks", "state"]
---
stateDiagram-v2
    [*] --> Provisioning
    Provisioning --> Current: Activated
    Current --> Retiring: Key Rotation Initiated
    Retiring --> Deprecated: Grace Window Expired
    Deprecated --> Purge: TTL / Manual Cleanup
    Purge --> [*]

    note right of Provisioning: Generate key pair<br/>Store kid + created_at
    note right of Current: Signs new tokens<br/>JWKS exposes kid
    note right of Retiring: Valid for verification only<br/>New tokens use CURRENT
    note right of Deprecated: Should not verify (unless forced rollback)
    note right of Purge: Row deletion or archive
